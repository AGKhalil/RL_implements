diff --git a/__pycache__/policies.cpython-36.pyc b/__pycache__/policies.cpython-36.pyc
index 175b219..38c4c35 100644
Binary files a/__pycache__/policies.cpython-36.pyc and b/__pycache__/policies.cpython-36.pyc differ
diff --git a/__pycache__/vpg.cpython-36.pyc b/__pycache__/vpg.cpython-36.pyc
index 6bbeb71..1c19d50 100644
Binary files a/__pycache__/vpg.cpython-36.pyc and b/__pycache__/vpg.cpython-36.pyc differ
diff --git a/main_ac_mcc.py b/main_ac_mcc.py
index 9bc5e75..b18544d 100644
--- a/main_ac_mcc.py
+++ b/main_ac_mcc.py
@@ -69,9 +69,8 @@ def net_layers(hidden, env_type, env):
     obs_space = env.observation_space.shape[0]
     return [obs_space] + hidden + [act_space]
 
-
 def main(lr_ac, lr_cr):
-	wandb.init(entity="agkhalil", project="pytorch-ac-mountaincarcont", reinit=True)
+	wandb.init(entity="agkhalil", project="pytorch-ac-mountaincarcont-bayesopt2", reinit=True)
 	wandb.watch_called = False
 
 	parser = argparse.ArgumentParser(description='PyTorch actor-critic example')
@@ -82,7 +81,7 @@ def main(lr_ac, lr_cr):
 	config = wandb.config
 	# config.update({"lr_ac": lr_ac, "lr_cr": lr_cr}, allow_val_change=True)
 	config.batch_size = 50
-	config.episodes = 10
+	config.episodes = 3000
 	config.lr_ac = lr_ac
 	config.lr_cr = lr_cr
 	config.seed = 42
diff --git a/vpg.py b/vpg.py
index 84ee0f4..39c4dd2 100644
--- a/vpg.py
+++ b/vpg.py
@@ -16,7 +16,7 @@ import torch.nn.functional as F
 import torch.optim as optim
 
 from scipy.special import softmax
-
+from sklearn import preprocessing
 import logging
 logging.propagate = False 
 logging.getLogger().setLevel(logging.ERROR)
@@ -59,7 +59,18 @@ class AC():
         self.policy = policy
         self.env_type = env_type
 
+        state_space_samples = np.array([self.env.observation_space.sample() for x in range(10000)])
+        self.scaler = preprocessing.StandardScaler()
+        self.scaler.fit(state_space_samples)
+
+    def scale_state(self, obs):                 #requires input shape=(2,)
+        scaled = self.scaler.transform([obs])
+        return scaled
+
     def get_action(self, obs, critic=False):
+        print('before', obs)
+        obs = self.scale_state(obs)
+        print('after', obs)
         if critic:
             return self.get_current_policy(obs, critic=critic)
         if self.env_type == 'DISCRETE':
@@ -70,7 +81,7 @@ class AC():
             return self.act, F.log_softmax(self.action_mean).squeeze(0)[self.act]
         else:
             self.action_mean, self.action_std = self.get_current_policy(obs)
-            self.dist = torch.distributions.normal.Normal(self.action_mean, 1)
+            self.dist = torch.distributions.normal.Normal(self.action_mean, self.action_std)
             self.act = self.dist.sample().squeeze()
             if self.act.nelement() == 1:                
                 return [self.act.item()], self.dist.log_prob(self.act)
@@ -78,4 +89,4 @@ class AC():
                 return self.act.numpy(), self.dist.log_prob(self.act)
 
     def get_current_policy(self, obs, critic=False):
-        return self.policy.forward(torch.from_numpy(obs).float().unsqueeze(0).to(self.device), critic)
\ No newline at end of file
+        return self.policy.forward(torch.from_numpy(obs).float().unsqueeze(0).to(self.device), critic)
diff --git a/wandb/debug.log b/wandb/debug.log
index f9c4e10..381c291 100644
--- a/wandb/debug.log
+++ b/wandb/debug.log
@@ -1,87 +1,16 @@
-2020-03-28 19:39:56,059 DEBUG   MainThread:941 [wandb_config.py:_load_defaults():122] no defaults not found in config-defaults.yaml
-2020-03-28 19:39:56,079 DEBUG   MainThread:941 [meta.py:setup():97] code probe starting
-2020-03-28 19:39:56,090 DEBUG   MainThread:941 [meta.py:_setup_code_git():49] probe for git information
-2020-03-28 19:39:56,215 DEBUG   MainThread:941 [meta.py:_setup_code_program():58] save program starting
-2020-03-28 19:39:56,215 DEBUG   MainThread:941 [meta.py:_setup_code_program():60] save program starting: /app/./main_ac_mcc.py
-2020-03-28 19:39:56,218 DEBUG   MainThread:941 [meta.py:_setup_code_program():65] save program saved: /app/wandb/run-20200328_193955-2jm5x7hd/code/main_ac_mcc.py
-2020-03-28 19:39:56,219 DEBUG   MainThread:941 [meta.py:_setup_code_program():67] save program
-2020-03-28 19:39:56,223 DEBUG   MainThread:941 [meta.py:setup():119] code probe done
-2020-03-28 19:39:56,233 DEBUG   MainThread:941 [run_manager.py:__init__():541] Initialized sync for pytorch-ac-mountaincarcont/2jm5x7hd
-2020-03-28 19:39:56,243 INFO    MainThread:941 [run_manager.py:wrap_existing_process():1144] wrapping existing process 358
-2020-03-28 19:39:56,243 WARNING MainThread:941 [io_wrap.py:register():104] SIGWINCH handler was not None: <Handlers.SIG_DFL: 0>
-2020-03-28 19:39:56,337 INFO    MainThread:941 [run_manager.py:init_run():924] system metrics and metadata threads started
-2020-03-28 19:39:56,339 INFO    MainThread:941 [run_manager.py:init_run():963] upserting run before process can begin, waiting at most 10 seconds
-2020-03-28 19:39:56,648 INFO    Thread-14 :941 [run_manager.py:_upsert_run():1048] saving patches
-2020-03-28 19:39:57,093 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/config.yaml
-2020-03-28 19:39:58,958 INFO    Thread-14 :941 [run_manager.py:_upsert_run():1052] saving pip packages
-2020-03-28 19:39:58,961 INFO    Thread-14 :941 [run_manager.py:_upsert_run():1054] initializing streaming files api
-2020-03-28 19:39:58,962 INFO    Thread-14 :941 [run_manager.py:_upsert_run():1061] unblocking file change observer, beginning sync with W&B servers
-2020-03-28 19:39:58,963 INFO    MainThread:941 [run_manager.py:wrap_existing_process():1161] informing user process we are ready to proceed
-2020-03-28 19:39:58,974 INFO    MainThread:941 [run_manager.py:_sync_etc():1268] entering loop for messages from user process
-2020-03-28 19:39:59,196 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:39:59,198 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-metadata.json
-2020-03-28 19:39:59,202 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/code/main_ac_mcc.py
-2020-03-28 19:39:59,208 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/code
-2020-03-28 19:39:59,209 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/diff.patch
-2020-03-28 19:39:59,213 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/diff.patch
-2020-03-28 19:39:59,216 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/config.yaml
-2020-03-28 19:39:59,220 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:39:59,222 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/requirements.txt
-2020-03-28 19:40:01,156 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/media/graph/graph_0_summary_84278387.graph.json
-2020-03-28 19:40:01,159 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:01,172 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/media
-2020-03-28 19:40:01,173 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/media/graph
-2020-03-28 19:40:02,182 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:03,197 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:04,214 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:05,230 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:06,248 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:07,261 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:08,277 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:09,291 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:10,344 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:11,361 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:40:12,379 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-metadata.json
-2020-03-28 19:40:13,394 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-history.jsonl
-2020-03-28 19:40:13,398 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:13,404 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:40:14,411 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-history.jsonl
-2020-03-28 19:40:15,424 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:15,429 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:40:16,438 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-history.jsonl
-2020-03-28 19:40:16,439 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:16,443 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:40:18,467 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-history.jsonl
-2020-03-28 19:40:18,469 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:18,473 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:40:19,489 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-history.jsonl
-2020-03-28 19:40:19,491 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:19,497 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:40:21,519 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-history.jsonl
-2020-03-28 19:40:21,521 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:21,528 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:40:23,549 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-history.jsonl
-2020-03-28 19:40:23,550 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:23,554 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:40:24,569 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-history.jsonl
-2020-03-28 19:40:24,571 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:24,576 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:40:24,578 INFO    Thread-3  :941 [run_manager.py:_on_file_created():677] file/dir created: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-events.jsonl
-2020-03-28 19:40:26,601 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-history.jsonl
-2020-03-28 19:40:26,603 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-summary.json
-2020-03-28 19:40:26,607 INFO    Thread-3  :941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/output.log
-2020-03-28 19:40:26,980 INFO    MainThread:941 [run_manager.py:_sync_etc():1291] received message from user process: {"exitcode": 0}
-2020-03-28 19:40:26,984 INFO    MainThread:941 [run_manager.py:_sync_etc():1377] closing log streams and sending exitcode to W&B
-2020-03-28 19:40:26,986 INFO    MainThread:941 [run_manager.py:shutdown():1068] shutting down system stats and metadata service
-2020-03-28 19:40:27,358 INFO    MainThread:941 [run_manager.py:shutdown():1080] stopping streaming files and file change observer
-2020-03-28 19:40:27,630 INFO    MainThread:941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-events.jsonl
-2020-03-28 19:40:27,632 INFO    MainThread:941 [run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-metadata.json
-2020-03-28 19:40:30,729 INFO    MainThread:941 [run_manager.py:_sync_etc():1396] rendering summary
-2020-03-28 19:40:30,734 INFO    MainThread:941 [run_manager.py:_sync_etc():1429] syncing files to cloud storage
-2020-03-28 19:40:32,505 INFO    MainThread:941 [run_manager.py:_sync_etc():1444] syncing complete: https://app.wandb.ai/agkhalil/pytorch-ac-mountaincarcont/runs/2jm5x7hd
-ge observer
-2020-03-28 19:40:27,630 INFO    MainThread:941 [2jm5x7hd:run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-events.jsonl
-2020-03-28 19:40:27,632 INFO    MainThread:941 [2jm5x7hd:run_manager.py:_on_file_modified():688] file/dir modified: /app/wandb/run-20200328_193955-2jm5x7hd/wandb-metadata.json
-2020-03-28 19:40:30,729 INFO    MainThread:941 [2jm5x7hd:run_manager.py:_sync_etc():1396] rendering summary
-2020-03-28 19:40:30,734 INFO    MainThread:941 [2jm5x7hd:run_manager.py:_sync_etc():1429] syncing files to cloud storage
-2020-03-28 19:40:32,505 INFO    MainThread:941 [2jm5x7hd:run_manager.py:_sync_etc():1444] syncing complete: https://app.wandb.ai/agkhalil/pytorch-ac-mountaincarcont/runs/2jm5x7hd
+2020-03-29 16:10:07,794 DEBUG   MainThread:1135 [wandb_config.py:_load_defaults():122] no defaults not found in config-defaults.yaml
+2020-03-29 16:10:07,800 DEBUG   MainThread:1135 [meta.py:setup():97] code probe starting
+2020-03-29 16:10:07,801 DEBUG   MainThread:1135 [meta.py:_setup_code_git():49] probe for git information
+2020-03-29 16:10:07,808 DEBUG   MainThread:1135 [meta.py:_setup_code_program():58] save program starting
+2020-03-29 16:10:07,808 DEBUG   MainThread:1135 [meta.py:_setup_code_program():60] save program starting: /app/./main_ac_mcc.py
+2020-03-29 16:10:07,808 DEBUG   MainThread:1135 [meta.py:_setup_code_program():65] save program saved: /app/wandb/run-20200329_161007-2qq0jw3g/code/main_ac_mcc.py
+2020-03-29 16:10:07,808 DEBUG   MainThread:1135 [meta.py:_setup_code_program():67] save program
+2020-03-29 16:10:07,808 DEBUG   MainThread:1135 [meta.py:setup():119] code probe done
+2020-03-29 16:10:07,817 DEBUG   MainThread:1135 [run_manager.py:__init__():545] Initialized sync for pytorch-ac-mountaincarcont-bayesopt2/2qq0jw3g
+2020-03-29 16:10:07,819 INFO    MainThread:1135 [run_manager.py:wrap_existing_process():1148] wrapping existing process 1110
+2020-03-29 16:10:07,819 WARNING MainThread:1135 [io_wrap.py:register():104] SIGWINCH handler was not None: <Handlers.SIG_DFL: 0>
+2020-03-29 16:10:07,859 INFO    MainThread:1135 [run_manager.py:init_run():928] system metrics and metadata threads started
+2020-03-29 16:10:07,859 INFO    MainThread:1135 [run_manager.py:init_run():967] upserting run before process can begin, waiting at most 10 seconds
+2020-03-29 16:10:08,035 INFO    Thread-14 :1135 [run_manager.py:_upsert_run():1052] saving patches
+ting run before process can begin, waiting at most 10 seconds
+2020-03-29 16:10:08,035 INFO    Thread-14 :1135 [2qq0jw3g:run_manager.py:_upsert_run():1052] saving patches
